openapi: 3.0.3
info:
  title: EA Tool API
  version: 1.0.0
  description: |
    API-first EA tool for cataloging applications, servers, integrations, and ArchiMate-based views.
    Time handling: all timestamps are UTC, ISO 8601 with trailing 'Z'.
    Identity: OpenID Connect (OIDC) tokens; Authorization: centralized Rego/OPA policies.
    Authorization details:
      - Inputs: subject (sub, email, roles, groups), action (read/write/delete), resource (type, id, owner, environment, tags), request context (method, path, scopes, tenant).
      - Decision: allow/deny with optional obligations (field redactions, filters); include trace id for audits; fail-closed on PDP errors.
      - Rego example (simplified):
          package authz

          default allow = false

          allow {
            input.action == "read"
            input.resource.type == "application"
            "viewer" in input.subject.roles
          }
  contact:
    name: EA Platform Team
servers:
  - url: https://api.example.com
    description: Production
  - url: https://staging.api.example.com
    description: Staging
  - url: http://localhost:8000
    description: Local
security:
  - bearerAuth: []
  - openId:
    - openid
    - profile
    - email
  - apiKey: []
tags:
  - name: Health
    description: Health and observability endpoints
  - name: Organizations
  - name: Applications
  - name: ApplicationServices
  - name: ApplicationInterfaces
  - name: Servers
  - name: Integrations
  - name: BusinessCapabilities
  - name: DataEntities
  - name: Relations
  - name: Views
  - name: Imports
  - name: Exports
  - name: Webhooks
paths:
  /health:
    get:
      tags: [Health]
      summary: Get service health status
      description: Returns health status with OpenTelemetry observability information
      security: []
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/HealthStatus'
  /organizations:
    get:
      tags: [Organizations]
      summary: List organizations
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
      responses:
        '200':
          description: List organizations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedOrganizations'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Organizations]
      summary: Create organization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /organizations/{id}:
    get:
      tags: [Organizations]
      summary: Get organization
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Organization
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      tags: [Organizations]
      summary: Update organization (dispatches to commands)
      description: |
        Updates organization by dispatching to appropriate commands based on changed fields.
        - Parent changes → SetParent or RemoveParent command
        - Name/domains/contacts changes → direct repository update (TODO: migrate to commands)
        For explicit command control, use /organizations/{id}/commands/* endpoints.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/OrganizationUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Organizations]
      summary: Delete organization
      description: Deletes organization with event sourcing
      parameters:
        - $ref: '#/components/parameters/idPath'
        - in: query
          name: reason
          schema:
            type: string
            default: User requested deletion
          description: Reason for deletion
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /organizations/{id}/commands/set-parent:
    post:
      tags: [Organizations]
      summary: Set organization parent with cycle detection
      description: |
        Assigns a parent organization to this organization.
        Validates that no cycles are created in the hierarchy (A→B→C→A).
        Uses event sourcing with ParentAssigned event.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - parent_id
              properties:
                parent_id:
                  type: string
                  description: ID of the parent organization
      responses:
        '200':
          description: Parent assigned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'
        '400':
          description: Validation error or cycle detected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /organizations/{id}/commands/remove-parent:
    post:
      tags: [Organizations]
      summary: Remove organization parent
      description: |
        Makes this organization a root organization by removing its parent.
        Uses event sourcing with ParentRemoved event.
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Parent removed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Organization'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /applications:
    get:
      tags: [Applications]
      summary: List applications
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: owner
          schema:
            type: string
        - in: query
          name: lifecycle
          schema:
            $ref: '#/components/schemas/Lifecycle'
      responses:
        '200':
          description: List applications
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedApplications'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Applications]
      summary: Create application
      description: |
        Creates a new application using CreateApplication command.
        Uses event sourcing with ApplicationCreated event.
        Validates lifecycle, data classification, and criticality values.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /applications/{id}:
    get:
      tags: [Applications]
      summary: Get application
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Application
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      tags: [Applications]
      summary: Update application (legacy - use commands)
      description: |
        Legacy update endpoint. Prefer using specific command endpoints:
        - /applications/{id}/commands/set-classification
        - /applications/{id}/commands/transition-lifecycle
        - /applications/{id}/commands/set-owner
        This endpoint is maintained for backward compatibility.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Applications]
      summary: Delete application (requires approval)
      description: |
        Deletes application using DeleteApplication command.
        Uses event sourcing with ApplicationDeleted event.
        Requires approval_id and deletion reason for audit trail.
      parameters:
        - $ref: '#/components/parameters/idPath'
        - in: query
          name: approval_id
          required: true
          schema:
            type: string
          description: Approval ID required for deletion
        - in: query
          name: reason
          required: true
          schema:
            type: string
          description: Reason for deletion
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /applications/{id}/commands/set-classification:
    post:
      tags: [Applications]
      summary: Set application data classification
      description: Updates the data classification with required justification
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - classification
                - reason
              properties:
                classification:
                  type: string
                  enum: [public, internal, confidential, restricted]
                reason:
                  type: string
                  description: Justification for the classification change
      responses:
        '200':
          description: Classification updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /applications/{id}/commands/transition-lifecycle:
    post:
      tags: [Applications]
      summary: Transition application lifecycle state
      description: Moves application through lifecycle state machine (planned→active→deprecated→retired)
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - target_lifecycle
              properties:
                target_lifecycle:
                  type: string
                  enum: [planned, active, deprecated, retired]
                sunset_date:
                  type: string
                  format: date
                  description: Optional sunset date when transitioning to deprecated
      responses:
        '200':
          description: Lifecycle transitioned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        '400':
          description: Invalid lifecycle transition or business rule violation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /applications/{id}/commands/set-owner:
    post:
      tags: [Applications]
      summary: Set application owner
      description: Updates the responsible owner for the application
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - owner
              properties:
                owner:
                  type: string
                reason:
                  type: string
                  description: Optional reason for ownership change
      responses:
        '200':
          description: Owner updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /servers:
    get:
      tags: [Servers]
      summary: List servers
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - in: query
          name: environment
          schema:
            type: string
        - in: query
          name: region
          schema:
            type: string
      responses:
        '200':
          description: List servers
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedServers'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Servers]
      summary: Create server
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServerCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Server'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /servers/{id}:
    get:
      tags: [Servers]
      summary: Get server
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Server
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Server'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      tags: [Servers]
      summary: Update server
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServerUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Server'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Servers]
      summary: Delete server
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /integrations:
    get:
      tags: [Integrations]
      summary: List integrations
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: source_app_id
          schema:
            type: string
        - in: query
          name: target_app_id
          schema:
            type: string
      responses:
        '200':
          description: List integrations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedIntegrations'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Integrations]
      summary: Create integration
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IntegrationCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Integration'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /integrations/{id}:
    get:
      tags: [Integrations]
      summary: Get integration
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Integration
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Integration'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      tags: [Integrations]
      summary: Update integration
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/IntegrationUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Integration'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Integrations]
      summary: Delete integration
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /business-capabilities:
    get:
      tags: [BusinessCapabilities]
      summary: List business capabilities
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: parent_id
          schema:
            type: string
          description: Filter by parent capability ID
      responses:
        '200':
          description: List business capabilities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedBusinessCapabilities'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [BusinessCapabilities]
      summary: Create business capability
      description: |
        Creates a new business capability with event sourcing.
        Optionally assigns a parent capability.
        Includes optional description field.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BusinessCapabilityCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BusinessCapability'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /business-capabilities/{id}:
    get:
      tags: [BusinessCapabilities]
      summary: Get business capability
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Business capability
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BusinessCapability'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /business-capabilities/{id}/commands/set-parent:
    post:
      tags: [BusinessCapabilities]
      summary: Set business capability parent with cycle detection
      description: |
        Assigns a parent business capability to this capability.
        Validates that no cycles are created in the hierarchy (A→B→C→A).
        Uses event sourcing with CapabilityParentAssigned event.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - parent_id
              properties:
                parent_id:
                  type: string
                  description: ID of the parent business capability
      responses:
        '200':
          description: Parent assigned
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BusinessCapability'
        '400':
          description: Validation error or cycle detected
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /business-capabilities/{id}/commands/remove-parent:
    post:
      tags: [BusinessCapabilities]
      summary: Remove business capability parent
      description: |
        Makes this business capability a root capability by removing its parent.
        Uses event sourcing with CapabilityParentRemoved event.
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Parent removed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BusinessCapability'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /business-capabilities/{id}/commands/update-description:
    post:
      tags: [BusinessCapabilities]
      summary: Update business capability description
      description: |
        Updates the description of a business capability.
        Uses event sourcing with CapabilityDescriptionUpdated event.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  type: string
                  nullable: true
                  description: Description of the business capability
      responses:
        '200':
          description: Description updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BusinessCapability'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /business-capabilities/{id}/commands/delete:
    post:
      tags: [BusinessCapabilities]
      summary: Delete business capability
      description: |
        Deletes a business capability with event sourcing.
        Uses CapabilityDeleted event.
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /data-entities:
    get:
      tags: [DataEntities]
      summary: List data entities
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: domain
          schema:
            type: string
        - in: query
          name: classification
          schema:
            type: string
        - in: query
          name: owner
          schema:
            type: string
      responses:
        '200':
          description: List data entities
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedDataEntities'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [DataEntities]
      summary: Create data entity
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DataEntityCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataEntity'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /data-entities/{id}:
    get:
      tags: [DataEntities]
      summary: Get data entity
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Data entity
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataEntity'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      tags: [DataEntities]
      summary: Update data entity
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DataEntityUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DataEntity'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [DataEntities]
      summary: Delete data entity
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /relations:
    get:
      tags: [Relations]
      summary: List relations
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: source_id
          schema:
            type: string
        - in: query
          name: target_id
          schema:
            type: string
        - in: query
          name: relation_type
          schema:
            type: string
      responses:
        '200':
          description: List relations
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedRelations'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Relations]
      summary: Create relation
      description: Unsupported source/target/relation_type combinations fail with 422 ValidationError.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RelationCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Relation'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /relations/{id}:
    get:
      tags: [Relations]
      summary: Get relation
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Relation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Relation'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /relations/{id}/commands/update-confidence:
    post:
      tags: [Relations]
      summary: Update relation confidence
      description: Updates the confidence level and verification metadata for a relation. Confidence must be between 0.0 and 1.0.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [confidence]
              properties:
                confidence:
                  type: number
                  format: float
                  minimum: 0.0
                  maximum: 1.0
                  description: Confidence level (0.0 to 1.0)
                evidence_source:
                  type: string
                  description: Source of evidence supporting this confidence level
                last_verified_at:
                  type: string
                  format: date-time
                  description: Timestamp of last verification
      responses:
        '200':
          description: Confidence updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Relation'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /relations/{id}/commands/set-effective-dates:
    post:
      tags: [Relations]
      summary: Set effective dates for temporal relations
      description: Sets the effective_from and effective_to dates. effective_from must be <= effective_to.
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                effective_from:
                  type: string
                  format: date-time
                  description: Start date of relation validity
                effective_to:
                  type: string
                  format: date-time
                  description: End date of relation validity
      responses:
        '200':
          description: Effective dates set
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Relation'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /relations/{id}/commands/update-description:
    post:
      tags: [Relations]
      summary: Update relation description
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                description:
                  type: string
                  maxLength: 2000
      responses:
        '200':
          description: Description updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Relation'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /relations/{id}/commands/delete:
    post:
      tags: [Relations]
      summary: Delete relation
      description: Soft deletes a relation with optional reason
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  description: Reason for deletion
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /views:
    get:
      tags: [Views]
      summary: List saved views
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
      responses:
        '200':
          description: List views
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedViews'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Views]
      summary: Create view
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ViewCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/View'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /views/{id}:
    get:
      tags: [Views]
      summary: Get view
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: View
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/View'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    patch:
      tags: [Views]
      summary: Update view
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ViewUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/View'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Views]
      summary: Delete view
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /views/{id}/render:
    get:
      tags: [Views]
      summary: Render a view to graph payload
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Graph payload
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Graph'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /imports:
    post:
      tags: [Imports]
      summary: Create import job
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImportJobCreate'
      responses:
        '202':
          description: Import job created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportJob'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /imports/{jobId}:
    get:
      tags: [Imports]
      summary: Get import job status
      parameters:
        - $ref: '#/components/parameters/jobIdPath'
      responses:
        '200':
          description: Import job
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImportJob'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /exports:
    post:
      tags: [Exports]
      summary: Create export job
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExportJobCreate'
      responses:
        '202':
          description: Export job created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportJob'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /exports/{jobId}:
    get:
      tags: [Exports]
      summary: Get export job status
      parameters:
        - $ref: '#/components/parameters/jobIdPath'
      responses:
        '200':
          description: Export job
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ExportJob'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /webhooks:
    get:
      tags: [Webhooks]
      summary: List webhooks
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
      responses:
        '200':
          description: List webhooks
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Webhook'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [Webhooks]
      summary: Create webhook
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebhookCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Webhook'
        '403':
          $ref: '#/components/responses/Forbidden'
  /webhooks/{id}:
    patch:
      tags: [Webhooks]
      summary: Update webhook
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/WebhookUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Webhook'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
    delete:
      tags: [Webhooks]
      summary: Delete webhook
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '204':
          description: Deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /webhooks/test:
    post:
      tags: [Webhooks]
      summary: Send test event to a webhook
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                webhook_id:
                  type: string
              required: [webhook_id]
      responses:
        '200':
          description: Delivered
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TestWebhookResult'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-services:
    get:
      tags: [ApplicationServices]
      summary: List application services
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: business_capability_id
          schema:
            type: string
      responses:
        '200':
          description: List application services
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedApplicationServices'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [ApplicationServices]
      summary: Create application service
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationServiceCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationService'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /application-services/{id}:
    get:
      tags: [ApplicationServices]
      summary: Get application service
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Application service
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationService'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-services/{id}/commands/update:
    post:
      tags: [ApplicationServices]
      summary: Update application service
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationServiceUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationService'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-services/{id}/commands/set-business-capability:
    post:
      tags: [ApplicationServices]
      summary: Set business capability for service
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                business_capability_id:
                  type: string
      responses:
        '200':
          description: Business capability set
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationService'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-services/{id}/commands/add-consumer:
    post:
      tags: [ApplicationServices]
      summary: Add consumer application to service
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [app_id]
              properties:
                app_id:
                  type: string
      responses:
        '200':
          description: Consumer added
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationService'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-services/{id}/commands/delete:
    post:
      tags: [ApplicationServices]
      summary: Delete application service
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  status:
                    type: string
                    example: deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-interfaces:
    get:
      tags: [ApplicationInterfaces]
      summary: List application interfaces
      parameters:
        - $ref: '#/components/parameters/page'
        - $ref: '#/components/parameters/limit'
        - $ref: '#/components/parameters/search'
        - in: query
          name: application_id
          schema:
            type: string
        - in: query
          name: status
          schema:
            $ref: '#/components/schemas/InterfaceStatus'
      responses:
        '200':
          description: List application interfaces
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedApplicationInterfaces'
        '403':
          $ref: '#/components/responses/Forbidden'
    post:
      tags: [ApplicationInterfaces]
      summary: Create application interface
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationInterfaceCreate'
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationInterface'
        '400':
          $ref: '#/components/responses/ValidationError'
        '422':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
  /application-interfaces/{id}:
    get:
      tags: [ApplicationInterfaces]
      summary: Get application interface
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Application interface
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationInterface'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-interfaces/{id}/commands/update:
    post:
      tags: [ApplicationInterfaces]
      summary: Update application interface
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ApplicationInterfaceUpdate'
      responses:
        '200':
          description: Updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationInterface'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-interfaces/{id}/commands/set-service:
    post:
      tags: [ApplicationInterfaces]
      summary: Set served application services
      parameters:
        - $ref: '#/components/parameters/idPath'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                service_ids:
                  type: array
                  items:
                    type: string
      responses:
        '200':
          description: Served services set
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationInterface'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-interfaces/{id}/commands/deprecate:
    post:
      tags: [ApplicationInterfaces]
      summary: Deprecate application interface
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Status updated to deprecated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationInterface'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-interfaces/{id}/commands/retire:
    post:
      tags: [ApplicationInterfaces]
      summary: Retire application interface
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Status updated to retired
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApplicationInterface'
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
  /application-interfaces/{id}/commands/delete:
    post:
      tags: [ApplicationInterfaces]
      summary: Delete application interface
      parameters:
        - $ref: '#/components/parameters/idPath'
      responses:
        '200':
          description: Deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  status:
                    type: string
                    example: deleted
        '400':
          $ref: '#/components/responses/ValidationError'
        '403':
          $ref: '#/components/responses/Forbidden'
        '404':
          $ref: '#/components/responses/NotFound'
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
    openId:
      type: openIdConnect
      openIdConnectUrl: https://auth.example.com/.well-known/openid-configuration
    apiKey:
      type: apiKey
      in: header
      name: X-Api-Key
  parameters:
    idPath:
      name: id
      in: path
      required: true
      schema:
        type: string
    jobIdPath:
      name: jobId
      in: path
      required: true
      schema:
        type: string
    page:
      name: page
      in: query
      schema:
        type: integer
        minimum: 1
      description: 1-based page number
    limit:
      name: limit
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 200
      description: Page size
    search:
      name: search
      in: query
      schema:
        type: string
  responses:
    Forbidden:
      description: Forbidden
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    NotFound:
      description: Not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/Error'
    ValidationError:
      description: Validation failed
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ValidationError'
  schemas:
    HealthStatus:
      type: object
      required:
        - status
        - service
        - version
        - environment
        - instance_id
        - uptime_seconds
        - timestamp
        - observability
      properties:
        status:
          type: string
          description: Overall health status
          example: healthy
        service:
          type: string
          description: Service name
          example: eatool-api
        version:
          type: string
          description: Service version
          example: 1.0.0
        environment:
          type: string
          description: Deployment environment
          example: production
        instance_id:
          type: string
          description: Service instance identifier
          example: api-pod-01
        uptime_seconds:
          type: number
          description: Service uptime in seconds
          example: 12345.67
        timestamp:
          type: string
          format: date-time
          description: Current server time in ISO 8601 format
          example: "2026-01-08T10:30:45.123Z"
        observability:
          $ref: '#/components/schemas/ObservabilityStatus'
    ObservabilityStatus:
      type: object
      required:
        - tracing_enabled
        - metrics_enabled
      properties:
        tracing_enabled:
          type: boolean
          description: Whether distributed tracing is enabled
          example: true
        metrics_enabled:
          type: boolean
          description: Whether metrics collection is enabled
          example: true
        otlp_endpoint:
          type: string
          nullable: true
          description: OpenTelemetry OTLP endpoint URL if configured
          example: "http://otel-collector:4317"
    InterfaceStatus:
      type: string
      enum: [active, deprecated, retired]
    Lifecycle:
      type: string
      enum: [planned, active, deprecated, retired]
    ApplicationService:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
          nullable: true
        business_capability_id:
          type: string
        sla:
          type: string
        exposed_by_app_ids:
          type: array
          items:
            type: string
        consumers:
          type: array
          items:
            type: string
        tags:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, created_at, updated_at]
      example:
        id: aps-1234abcd
        name: Customer Lookup
        description: Provides customer search capability
        business_capability_id: cap-1
        sla: 99.9%
        exposed_by_app_ids: [app-123]
        consumers: [app-456]
        tags: [customer, search]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    ApplicationServiceCreate:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        business_capability_id:
          type: string
        sla:
          type: string
        exposed_by_app_ids:
          type: array
          items:
            type: string
        tags:
          type: array
          items:
            type: string
      required: [name]
      example:
        name: Customer Lookup
        description: Provides customer search capability
        business_capability_id: cap-1
        sla: 99.9%
        exposed_by_app_ids: [app-123]
        tags: [customer, search]
    ApplicationServiceUpdate:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        sla:
          type: string
        tags:
          type: array
          items:
            type: string
      example:
        description: Updated description
        sla: 99.95%
        tags: [customer, api]
    ApplicationInterface:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        protocol:
          type: string
        endpoint:
          type: string
          nullable: true
        specification_url:
          type: string
          nullable: true
        version:
          type: string
          nullable: true
        authentication_method:
          type: string
          nullable: true
        exposed_by_app_id:
          type: string
        serves_service_ids:
          type: array
          items:
            type: string
        rate_limits:
          type: object
          additionalProperties:
            type: string
          nullable: true
        status:
          $ref: '#/components/schemas/InterfaceStatus'
        tags:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, protocol, exposed_by_app_id, status, created_at, updated_at]
      example:
        id: aif-1234abcd
        name: Customer REST API
        protocol: https
        endpoint: https://api.example.com/customers
        specification_url: https://api.example.com/customers/openapi.json
        version: v1
        authentication_method: oauth2
        exposed_by_app_id: app-123
        serves_service_ids: [aps-1234abcd]
        rate_limits:
          per_minute: "1000"
          per_day: "50000"
        status: active
        tags: [customer, public]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    ApplicationInterfaceCreate:
      type: object
      properties:
        name:
          type: string
        protocol:
          type: string
        endpoint:
          type: string
        specification_url:
          type: string
        version:
          type: string
        authentication_method:
          type: string
        exposed_by_app_id:
          type: string
        serves_service_ids:
          type: array
          items:
            type: string
        status:
          $ref: '#/components/schemas/InterfaceStatus'
        tags:
          type: array
          items:
            type: string
      required: [name, protocol, exposed_by_app_id, status]
      example:
        name: Customer REST API
        protocol: https
        endpoint: https://api.example.com/customers
        specification_url: https://api.example.com/customers/openapi.json
        version: v1
        authentication_method: oauth2
        exposed_by_app_id: app-123
        serves_service_ids: [aps-1234abcd]
        status: active
        tags: [customer, public]
    ApplicationInterfaceUpdate:
      type: object
      properties:
        name:
          type: string
        protocol:
          type: string
        endpoint:
          type: string
        version:
          type: string
        authentication_method:
          type: string
        tags:
          type: array
          items:
            type: string
      example:
        name: Customer REST API v2
        version: v2
        tags: [customer, public]
    Error:
      type: object
      properties:
        code:
          type: string
          example: forbidden
        message:
          type: string
          example: You do not have access to this resource
        trace_id:
          type: string
          example: req-1234abcd
      required: [code, message]
      example:
        code: forbidden
        message: You do not have access to this resource
        trace_id: req-1234abcd
    ValidationError:
      type: object
      properties:
        code:
          type: string
          example: validation_error
        message:
          type: string
          example: Request validation failed
        trace_id:
          type: string
        errors:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
              message:
                type: string
      required: [code, message, errors]
      example:
        code: validation_error
        message: Request validation failed
        trace_id: req-5678efgh
        errors:
          - field: name
            message: Name is required
    Organization:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        parent_id:
          type: string
          nullable: true
          description: FK to parent organization for hierarchical structures
        domains:
          type: array
          items:
            type: string
        contacts:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, created_at, updated_at]
      example:
        id: org-123
        name: Payments Team
        parent_id: org-100
        domains: [example.com]
        contacts: [owner@example.com]
        created_at: 2024-01-01T00:00:00Z
        updated_at: 2024-01-02T00:00:00Z
    OrganizationCreate:
      type: object
      properties:
        name:
          type: string
        parent_id:
          type: string
          nullable: true
          description: FK to parent organization for hierarchical structures
        domains:
          type: array
          items:
            type: string
        contacts:
          type: array
          items:
            type: string
      required: [name]
      example:
        name: Payments Team
        parent_id: org-100
        domains: [example.com]
        contacts: [owner@example.com]
    OrganizationUpdate:
      type: object
      properties:
        name:
          type: string
        parent_id:
          type: string
          nullable: true
          description: FK to parent organization for hierarchical structures
        domains:
          type: array
          items:
            type: string
        contacts:
          type: array
          items:
            type: string
      example:
        name: Updated Org
        parent_id: org-200
        domains: [example.org]
        contacts: [new-owner@example.org]
    Application:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        owner:
          type: string
        lifecycle:
          $ref: '#/components/schemas/Lifecycle'
        capability_id:
          type: string
        data_classification:
          type: string
        tags:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, lifecycle, created_at, updated_at]
      example:
        id: app-123
        name: Billing Service
        owner: payments-team
        lifecycle: active
        capability_id: cap-1
        data_classification: confidential
        tags: [payments, pci]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    ApplicationCreate:
      type: object
      properties:
        name:
          type: string
        owner:
          type: string
        lifecycle:
          $ref: '#/components/schemas/Lifecycle'
        capability_id:
          type: string
        data_classification:
          type: string
        tags:
          type: array
          items:
            type: string
      required: [name, lifecycle]
      example:
        name: Billing Service
        owner: payments-team
        lifecycle: active
        capability_id: cap-1
        data_classification: confidential
        tags: [payments, pci]
    ApplicationUpdate:
      type: object
      properties:
        name:
          type: string
        owner:
          type: string
        lifecycle:
          $ref: '#/components/schemas/Lifecycle'
        capability_id:
          type: string
        data_classification:
          type: string
        tags:
          type: array
          items:
            type: string
      example:
        owner: payments-team
        lifecycle: deprecated
        tags: [payments, cleanup]
    Server:
      type: object
      properties:
        id:
          type: string
        hostname:
          type: string
        environment:
          type: string
        region:
          type: string
        platform:
          type: string
        criticality:
          type: string
        owning_team:
          type: string
        tags:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, hostname, created_at, updated_at]
      example:
        id: srv-123
        hostname: srv-billing-01
        environment: prod
        region: eu-west-1
        platform: linux
        criticality: high
        owning_team: payments
        tags: [payments, pci]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    ServerCreate:
      type: object
      properties:
        hostname:
          type: string
        environment:
          type: string
        region:
          type: string
        platform:
          type: string
        criticality:
          type: string
        owning_team:
          type: string
        tags:
          type: array
          items:
            type: string
      required: [hostname]
      example:
        hostname: srv-billing-01
        environment: prod
        region: eu-west-1
        platform: linux
        criticality: high
        owning_team: payments
        tags: [payments, pci]
    ServerUpdate:
      type: object
      properties:
        hostname:
          type: string
        environment:
          type: string
        region:
          type: string
        platform:
          type: string
        criticality:
          type: string
        owning_team:
          type: string
        tags:
          type: array
          items:
            type: string
      example:
        environment: staging
        region: us-east-1
        tags: [payments, blue]
    Integration:
      type: object
      properties:
        id:
          type: string
        source_app_id:
          type: string
        target_app_id:
          type: string
        protocol:
          type: string
        data_contract:
          type: string
        sla:
          type: string
        frequency:
          type: string
        tags:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, source_app_id, target_app_id, created_at, updated_at]
      example:
        id: int-123
        source_app_id: app-123
        target_app_id: app-456
        protocol: https
        data_contract: json-schema
        sla: 99.9%
        frequency: realtime
        tags: [payments, webhook]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    IntegrationCreate:
      type: object
      properties:
        source_app_id:
          type: string
        target_app_id:
          type: string
        protocol:
          type: string
        data_contract:
          type: string
        sla:
          type: string
        frequency:
          type: string
        tags:
          type: array
          items:
            type: string
      required: [source_app_id, target_app_id]
      example:
        source_app_id: app-123
        target_app_id: app-456
        protocol: https
        data_contract: json-schema
        sla: 99.9%
        frequency: realtime
        tags: [payments, webhook]
    IntegrationUpdate:
      type: object
      properties:
        source_app_id:
          type: string
        target_app_id:
          type: string
        protocol:
          type: string
        data_contract:
          type: string
        sla:
          type: string
        frequency:
          type: string
        tags:
          type: array
          items:
            type: string
      example:
        protocol: kafka
        frequency: hourly
        tags: [payments, batch]
    BusinessCapability:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        parent_id:
          type: string
        description:
          type: string
          nullable: true
          description: Optional description of the business capability
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, created_at, updated_at]
      example:
        id: cap-1
        name: Payments
        parent_id: cap-root
        description: Handles all payment processing
        created_at: 2024-01-01T00:00:00Z
        updated_at: 2024-01-02T00:00:00Z
    BusinessCapabilityCreate:
      type: object
      properties:
        name:
          type: string
        parent_id:
          type: string
        description:
          type: string
          nullable: true
          description: Optional description of the business capability
      required: [name]
      example:
        name: Payments
        parent_id: cap-root
        description: Handles all payment processing
    BusinessCapabilityUpdate:
      type: object
      properties:
        name:
          type: string
        parent_id:
          type: string
      example:
        name: Payments Modernization
    DataEntity:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        domain:
          type: string
        classification:
          type: string
        retention:
          type: string
        owner:
          type: string
        steward:
          type: string
        source_system:
          type: string
        criticality:
          type: string
        pii_flag:
          type: boolean
        glossary_terms:
          type: array
          items:
            type: string
        lineage:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, classification, created_at, updated_at]
      example:
        id: data-1
        name: Customer Profile
        domain: customer
        classification: confidential
        retention: 2y
        owner: data-platform
        steward: data-governance
        source_system: crm
        criticality: high
        pii_flag: true
        glossary_terms: [customer, profile]
        lineage: [crm-db, marketing-dwh]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    DataEntityCreate:
      type: object
      properties:
        name:
          type: string
        domain:
          type: string
        classification:
          type: string
        retention:
          type: string
        owner:
          type: string
        steward:
          type: string
        source_system:
          type: string
        criticality:
          type: string
        pii_flag:
          type: boolean
        glossary_terms:
          type: array
          items:
            type: string
        lineage:
          type: array
          items:
            type: string
      required: [name, classification]
      example:
        name: Customer Profile
        domain: customer
        classification: confidential
        retention: 2y
        owner: data-platform
        steward: data-governance
        source_system: crm
        pii_flag: true
        glossary_terms: [customer, profile]
    DataEntityUpdate:
      type: object
      properties:
        name:
          type: string
        domain:
          type: string
        classification:
          type: string
        retention:
          type: string
        owner:
          type: string
        steward:
          type: string
        source_system:
          type: string
        criticality:
          type: string
        pii_flag:
          type: boolean
        glossary_terms:
          type: array
          items:
            type: string
        lineage:
          type: array
          items:
            type: string
      example:
        classification: restricted
        retention: 1y
        pii_flag: false
        glossary_terms: [customer, pii]
    Relation:
      type: object
      properties:
        id:
          type: string
        source_id:
          type: string
        target_id:
          type: string
        source_type:
          type: string
          enum: [organization, application, application_service, application_interface, server, integration, business_capability, data_entity, view]
        target_type:
          type: string
          enum: [organization, application, application_service, application_interface, server, integration, business_capability, data_entity, view]
        relation_type:
          type: string
          enum: [depends_on, communicates_with, calls, publishes_event_to, consumes_event_from, deployed_on, stores_data_on, reads, writes, owns, supports, implements, realizes, serves, connected_to, exposes, uses, part_of]
          description: |
            Allowed pairs (source_type -> target_type):
              - application -> application: depends_on, communicates_with, calls, publishes_event_to, consumes_event_from
              - application -> application_service: realizes, uses
              - application -> application_interface: exposes
              - application -> server: deployed_on, stores_data_on
              - application -> data_entity: reads, writes
              - application -> business_capability: supports
              - application_service -> business_capability: realizes, supports
              - application_interface -> application_service: serves
              - integration -> application: communicates_with, publishes_event_to, consumes_event_from
              - integration -> application_interface: calls, uses
              - server -> server: connected_to
              - organization -> organization: part_of
              - organization -> application: owns
              - organization -> server: owns
              - business_capability -> application: realizes, implements, serves
        archimate_element:
          type: string
        archimate_relationship:
          type: string
          enum: [Assignment, Realization, Serving, Access, Flow, Triggering, Association, Composition, Aggregation, Specialization, Influence]
        description:
          type: string
        data_classification:
          type: string
        criticality:
          type: string
        confidence:
          type: number
          format: float
          minimum: 0
          maximum: 1
        evidence_source:
          type: string
        last_verified_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        effective_from:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        effective_to:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        label:
          type: string
        color:
          type: string
        style:
          type: string
          enum: [solid, dashed]
        bidirectional:
          type: boolean
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, source_id, target_id, source_type, target_type, relation_type, created_at, updated_at]
      example:
        id: rel-1
        source_id: app-123
        target_id: srv-123
        source_type: application
        target_type: server
        relation_type: deployed_on
        archimate_element: ApplicationComponent
        archimate_relationship: Assignment
        description: App deployed on server
        data_classification: internal
        criticality: high
        confidence: 0.9
        evidence_source: cmdb
        last_verified_at: 2024-01-06T10:00:00Z
        effective_from: 2024-01-01T00:00:00Z
        label: Deploys to
        style: solid
        bidirectional: false
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    RelationCreate:
      type: object
      properties:
        source_id:
          type: string
        target_id:
          type: string
        source_type:
          type: string
          enum: [organization, application, application_service, application_interface, server, integration, business_capability, data_entity, view]
        target_type:
          type: string
          enum: [organization, application, application_service, application_interface, server, integration, business_capability, data_entity, view]
        relation_type:
          type: string
          enum: [depends_on, communicates_with, calls, publishes_event_to, consumes_event_from, deployed_on, stores_data_on, reads, writes, owns, supports, implements, realizes, serves, connected_to, exposes, uses, part_of]
          description: |
            Allowed pairs (source_type -> target_type):
              - application -> application: depends_on, communicates_with, calls, publishes_event_to, consumes_event_from
              - application -> application_service: realizes, uses
              - application -> application_interface: exposes
              - application -> server: deployed_on, stores_data_on
              - application -> data_entity: reads, writes
              - application -> business_capability: supports
              - application_service -> business_capability: realizes, supports
              - application_interface -> application_service: serves
              - integration -> application: communicates_with, publishes_event_to, consumes_event_from
              - integration -> application_interface: calls, uses
              - server -> server: connected_to
              - organization -> organization: part_of
              - organization -> application: owns
              - organization -> server: owns
              - business_capability -> application: realizes, implements, serves
        archimate_element:
          type: string
        archimate_relationship:
          type: string
          enum: [Assignment, Realization, Serving, Access, Flow, Triggering, Association, Composition, Aggregation, Specialization, Influence]
        description:
          type: string
        data_classification:
          type: string
        criticality:
          type: string
        confidence:
          type: number
          format: float
          minimum: 0
          maximum: 1
        evidence_source:
          type: string
        last_verified_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        effective_from:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        effective_to:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        label:
          type: string
        color:
          type: string
        style:
          type: string
          enum: [solid, dashed]
        bidirectional:
          type: boolean
      required: [source_id, target_id, source_type, target_type, relation_type]
      example:
        source_id: app-123
        target_id: srv-123
        source_type: application
        target_type: server
        relation_type: deployed_on
        archimate_element: ApplicationComponent
        archimate_relationship: Assignment
        description: App deployed on server
        data_classification: internal
        confidence: 0.9
        evidence_source: cmdb
        label: Deploys to
        style: solid
    RelationUpdate:
      type: object
      properties:
        source_id:
          type: string
        target_id:
          type: string
        source_type:
          type: string
          enum: [organization, application, application_service, application_interface, server, integration, business_capability, data_entity, view]
        target_type:
          type: string
          enum: [organization, application, application_service, application_interface, server, integration, business_capability, data_entity, view]
        relation_type:
          type: string
          enum: [depends_on, communicates_with, calls, publishes_event_to, consumes_event_from, deployed_on, stores_data_on, reads, writes, owns, supports, implements, realizes, serves, connected_to, exposes, uses, part_of]
          description: |
            Allowed pairs (source_type -> target_type):
              - application -> application: depends_on, communicates_with, calls, publishes_event_to, consumes_event_from
              - application -> application_service: realizes, uses
              - application -> application_interface: exposes
              - application -> server: deployed_on, stores_data_on
              - application -> data_entity: reads, writes
              - application -> business_capability: supports
              - application_service -> business_capability: realizes, supports
              - application_interface -> application_service: serves
              - integration -> application: communicates_with, publishes_event_to, consumes_event_from
              - integration -> application_interface: calls, uses
              - server -> server: connected_to
              - organization -> organization: part_of
              - organization -> application: owns
              - organization -> server: owns
              - business_capability -> application: realizes, implements, serves
        archimate_element:
          type: string
        archimate_relationship:
          type: string
          enum: [Assignment, Realization, Serving, Access, Flow, Triggering, Association, Composition, Aggregation, Specialization, Influence]
        description:
          type: string
        data_classification:
          type: string
        criticality:
          type: string
        confidence:
          type: number
          format: float
          minimum: 0
          maximum: 1
        evidence_source:
          type: string
        last_verified_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        effective_from:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        effective_to:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        label:
          type: string
        color:
          type: string
        style:
          type: string
          enum: [solid, dashed]
        bidirectional:
          type: boolean
      example:
        relation_type: communicates_with
        archimate_relationship: Flow
        description: Bidirectional sync
        confidence: 0.7
        bidirectional: true
    View:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        filter:
          type: object
        layout:
          type: object
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, name, created_at, updated_at]
      example:
        id: view-1
        name: Payments Landscape
        description: Key services and servers
        filter:
          tags: [payments]
        layout:
          engine: dagre
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-06T10:00:00Z
    ViewCreate:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        filter:
          type: object
        layout:
          type: object
      required: [name]
      example:
        name: Payments Landscape
        description: Key services and servers
        filter:
          tags: [payments]
        layout:
          engine: dagre
    ViewUpdate:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
        filter:
          type: object
        layout:
          type: object
      example:
        description: Updated to include batch flows
    GraphNode:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
        archimate_element:
          type: string
        label:
          type: string
        attrs:
          type: object
        data:
          type: object
    GraphEdge:
      type: object
      properties:
        id:
          type: string
        source:
          type: string
        target:
          type: string
        archimate_relationship:
          type: string
        relation_type:
          type: string
        label:
          type: string
        attrs:
          type: object
    Graph:
      type: object
      properties:
        nodes:
          type: array
          items:
            $ref: '#/components/schemas/GraphNode'
        edges:
          type: array
          items:
            $ref: '#/components/schemas/GraphEdge'
        layout:
          type: object
        filters:
          type: object
    ImportJob:
      type: object
      properties:
        id:
          type: string
        status:
          type: string
          enum: [pending, running, completed, failed]
        input_type:
          type: string
        created_by:
          type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        error:
          type: string
      required: [id, status, input_type, created_at, updated_at]
      example:
        id: imp-123
        status: running
        input_type: s3
        created_by: user@example.com
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-05T10:05:00Z
    ImportJobCreate:
      type: object
      properties:
        input_type:
          type: string
        upload_url:
          type: string
        format:
          type: string
          enum: [csv, xlsx, json]
      required: [input_type, format]
      example:
        input_type: s3
        upload_url: https://s3.example.com/bucket/key
        format: csv
    ExportJob:
      type: object
      properties:
        id:
          type: string
        status:
          type: string
          enum: [pending, running, completed, failed]
        filter:
          type: object
        created_by:
          type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        download_url:
          type: string
        error:
          type: string
      required: [id, status, created_at, updated_at]
      example:
        id: exp-123
        status: pending
        filter:
          capability_id: cap-1
        created_by: user@example.com
        created_at: 2024-01-05T11:00:00Z
        updated_at: 2024-01-05T11:00:00Z
    ExportJobCreate:
      type: object
      properties:
        filter:
          type: object
      required: [filter]
      example:
        filter:
          tags: [payments]
    Webhook:
      type: object
      properties:
        id:
          type: string
        url:
          type: string
        secret:
          type: string
        active:
          type: boolean
        events:
          type: array
          items:
            type: string
        created_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        updated_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
        last_failure_at:
          type: string
          format: date-time
          description: UTC ISO 8601 with Z
      required: [id, url, active, events, created_at, updated_at]
      example:
        id: wh-123
        url: https://hooks.example.com/events
        secret: whsec_abc123
        active: true
        events: [application.created, server.updated]
        created_at: 2024-01-05T10:00:00Z
        updated_at: 2024-01-05T10:30:00Z
        last_failure_at: 2024-01-05T09:55:00Z
    WebhookCreate:
      type: object
      properties:
        url:
          type: string
        events:
          type: array
          items:
            type: string
        active:
          type: boolean
      required: [url, events]
      example:
        url: https://hooks.example.com/events
        events: [application.created, server.updated]
        active: true
    WebhookUpdate:
      type: object
      properties:
        url:
          type: string
        events:
          type: array
          items:
            type: string
        active:
          type: boolean
      example:
        active: false
        events: [application.updated]
    TestWebhookResult:
      type: object
      properties:
        delivered:
          type: boolean
        status:
          type: string
      example:
        delivered: true
        status: ok
    PaginatedOrganizations:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Organization'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedDataEntities:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/DataEntity'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedApplications:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Application'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedServers:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Server'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedApplicationServices:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ApplicationService'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedApplicationInterfaces:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/ApplicationInterface'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedIntegrations:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Integration'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedBusinessCapabilities:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/BusinessCapability'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedRelations:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Relation'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
    PaginatedViews:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/View'
        page:
          type: integer
        limit:
          type: integer
        total:
          type: integer
